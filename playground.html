<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wordle Solver - Standalone</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2rem;
        margin-bottom: 10px;
      }

      .header p {
        opacity: 0.9;
      }

      .content {
        padding: 30px;
      }

      .section {
        margin-bottom: 30px;
      }

      .section h2 {
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: #333;
        border-bottom: 2px solid #667eea;
        padding-bottom: 8px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #555;
      }

      input,
      textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        font-size: 1rem;
        transition: border-color 0.3s;
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: #667eea;
      }

      .help-text {
        font-size: 0.85rem;
        color: #666;
        margin-top: 5px;
      }

      .position-inputs {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 10px;
        margin-top: 10px;
      }

      .position-input {
        display: flex;
        flex-direction: column;
      }

      .position-input label {
        font-size: 0.85rem;
        text-align: center;
      }

      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 6px;
        cursor: pointer;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        width: 100%;
        margin-top: 10px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .loading {
        text-align: center;
        padding: 20px;
        color: #667eea;
        font-weight: 600;
      }

      .error {
        background: #fee;
        border: 2px solid #fcc;
        color: #c33;
        padding: 15px;
        border-radius: 6px;
        margin-bottom: 20px;
      }

      .results {
        margin-top: 30px;
      }

      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .count {
        background: #667eea;
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 600;
      }

      .words-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 10px;
        margin-top: 15px;
      }

      .word-card {
        background: #f5f5f5;
        border: 2px solid #e0e0e0;
        padding: 15px;
        text-align: center;
        border-radius: 6px;
        font-weight: 600;
        font-size: 1.1rem;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s;
      }

      .word-card:hover {
        background: #667eea;
        color: white;
        border-color: #667eea;
        transform: scale(1.05);
      }

      .json-display {
        background: #f5f5f5;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        padding: 15px;
        margin-top: 15px;
        overflow-x: auto;
      }

      pre {
        margin: 0;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .position-inputs {
          grid-template-columns: repeat(5, 1fr);
          gap: 5px;
        }

        .words-grid {
          grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üß© Wordle Solver</h1>
        <p>Standalone client-side solver - works offline!</p>
      </div>

      <div class="content">
        <form id="wordleForm">
          <div class="section">
            <h2>Accepted Characters</h2>
            <div class="form-group">
              <label for="acceptedChars"
                >Letters that MUST be in the word (comma-separated)</label
              >
              <input
                type="text"
                id="acceptedChars"
                placeholder="c, a, t"
                value=""
              />
              <div class="help-text">
                Enter letters separated by commas (e.g., c, a, t)
              </div>
            </div>
          </div>

          <div class="section">
            <h2>Denied Characters</h2>
            <div class="form-group">
              <label for="deniedChars"
                >Letters that CANNOT be in the word (comma-separated)</label
              >
              <input
                type="text"
                id="deniedChars"
                placeholder="r, n, e, s"
                value=""
              />
              <div class="help-text">
                Enter letters separated by commas (e.g., r, n, e, s)
              </div>
            </div>
          </div>

          <div class="section">
            <h2>Known Positions (Green Tiles)</h2>
            <div class="form-group">
              <label>Letters that are in the correct position</label>
              <div class="position-inputs">
                <div class="position-input">
                  <label>Pos 1</label>
                  <input
                    type="text"
                    id="knownPos1"
                    maxlength="1"
                    placeholder="?"
                  />
                </div>
                <div class="position-input">
                  <label>Pos 2</label>
                  <input
                    type="text"
                    id="knownPos2"
                    maxlength="1"
                    placeholder="?"
                  />
                </div>
                <div class="position-input">
                  <label>Pos 3</label>
                  <input
                    type="text"
                    id="knownPos3"
                    maxlength="1"
                    placeholder="?"
                  />
                </div>
                <div class="position-input">
                  <label>Pos 4</label>
                  <input
                    type="text"
                    id="knownPos4"
                    maxlength="1"
                    placeholder="?"
                  />
                </div>
                <div class="position-input">
                  <label>Pos 5</label>
                  <input
                    type="text"
                    id="knownPos5"
                    maxlength="1"
                    placeholder="?"
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="section">
            <h2>Rejected Positions (Yellow/Grey Tiles)</h2>
            <div class="form-group">
              <label>Letters that CANNOT be at specific positions</label>
              <div class="help-text" style="margin-bottom: 10px">
                Enter letters separated by commas for each position (e.g., a, b
                for position 1)
              </div>
              <div class="position-inputs">
                <div class="position-input">
                  <label>Pos 1</label>
                  <input type="text" id="rejectedPos1" placeholder="a, b" />
                </div>
                <div class="position-input">
                  <label>Pos 2</label>
                  <input type="text" id="rejectedPos2" placeholder="a, b" />
                </div>
                <div class="position-input">
                  <label>Pos 3</label>
                  <input type="text" id="rejectedPos3" placeholder="a, b" />
                </div>
                <div class="position-input">
                  <label>Pos 4</label>
                  <input type="text" id="rejectedPos4" placeholder="a, b" />
                </div>
                <div class="position-input">
                  <label>Pos 5</label>
                  <input type="text" id="rejectedPos5" placeholder="a, b" />
                </div>
              </div>
            </div>
          </div>

          <button type="submit" id="solveBtn">Solve Wordle üöÄ</button>
        </form>

        <div id="errorContainer"></div>
        <div id="loadingContainer"></div>

        <div class="results" id="resultsContainer" style="display: none">
          <div class="results-header">
            <h2>Results</h2>
            <div class="count" id="countBadge">0 words</div>
          </div>
          <div class="words-grid" id="wordsGrid"></div>
          <div class="section">
            <h2>Request JSON</h2>
            <div class="json-display">
              <pre id="requestJson"></pre>
            </div>
          </div>
          <div class="section">
            <h2>Response JSON</h2>
            <div class="json-display">
              <pre id="responseJson"></pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Word list - loaded from CDN
      let wordList = []
      let wordListLoaded = false

      // Constraint validation functions
      function hasAllRequiredCharacters(word, acceptedChars) {
        return acceptedChars.every(char => word.includes(char))
      }

      function hasCorrectKnownPositions(word, knownPositions) {
        const knownPositionKeys = Object.keys(knownPositions).map(Number)
        for (const position of knownPositionKeys) {
          if (word.charAt(position - 1) !== knownPositions[position]) {
            return false
          }
        }
        return true
      }

      function hasValidRejectedPositions(word, rejectedPositions) {
        const rejectedPositionKeys = Object.keys(rejectedPositions).map(Number)
        for (const position of rejectedPositionKeys) {
          const rejectedChars = rejectedPositions[position] || []
          const currentChar = word.charAt(position - 1)
          if (rejectedChars.includes(currentChar)) {
            return false
          }
        }
        return true
      }

      function doesNotContainDeniedChars(word, deniedChars) {
        return !deniedChars.some(char => word.includes(char))
      }

      // Load word list from CDN
      async function loadWordList() {
        if (wordListLoaded) return wordList

        try {
          const response = await fetch(
            'https://raw.githubusercontent.com/darkermango/5-Letter-words/main/words.json',
          )
          const data = await response.json()
          wordList = data.words || data || []
          wordListLoaded = true
          return wordList
        } catch (error) {
          console.error('Failed to load word list:', error)
          throw new Error(
            'Failed to load word list. Please check your internet connection.',
          )
        }
      }

      // Client-side solver
      async function solveWordle(constraints) {
        await loadWordList()

        // Filter 5-letter words only
        let validWords = wordList.filter(
          word => typeof word === 'string' && word.length === 5,
        )

        // Filter by denied characters
        if (constraints.deniedChars.length > 0) {
          validWords = validWords.filter(word =>
            doesNotContainDeniedChars(word, constraints.deniedChars),
          )
        }

        // Filter by accepted characters
        if (constraints.acceptedChars.length > 0) {
          validWords = validWords.filter(word =>
            hasAllRequiredCharacters(word, constraints.acceptedChars),
          )
        }

        // Filter by known positions
        if (Object.keys(constraints.knownPositions).length > 0) {
          validWords = validWords.filter(word =>
            hasCorrectKnownPositions(word, constraints.knownPositions),
          )
        }

        // Filter by rejected positions
        if (Object.keys(constraints.rejectedPositions).length > 0) {
          validWords = validWords.filter(word =>
            hasValidRejectedPositions(word, constraints.rejectedPositions),
          )
        }

        return validWords.map(word => word.toLowerCase())
      }

      // UI elements
      const form = document.getElementById('wordleForm')
      const solveBtn = document.getElementById('solveBtn')
      const errorContainer = document.getElementById('errorContainer')
      const loadingContainer = document.getElementById('loadingContainer')
      const resultsContainer = document.getElementById('resultsContainer')
      const wordsGrid = document.getElementById('wordsGrid')
      const countBadge = document.getElementById('countBadge')
      const requestJson = document.getElementById('requestJson')
      const responseJson = document.getElementById('responseJson')

      function showError(message) {
        errorContainer.innerHTML = `<div class="error">${message}</div>`
        resultsContainer.style.display = 'none'
      }

      function clearError() {
        errorContainer.innerHTML = ''
      }

      function showLoading() {
        loadingContainer.innerHTML = '<div class="loading">Solving... ‚è≥</div>'
        resultsContainer.style.display = 'none'
        clearError()
        solveBtn.disabled = true
      }

      function hideLoading() {
        loadingContainer.innerHTML = ''
        solveBtn.disabled = false
      }

      function buildConstraints() {
        const acceptedCharsInput = document
          .getElementById('acceptedChars')
          .value.trim()
        const deniedCharsInput = document
          .getElementById('deniedChars')
          .value.trim()

        const acceptedChars = acceptedCharsInput
          ? acceptedCharsInput
              .split(',')
              .map(c => c.trim().toLowerCase())
              .filter(c => c.length === 1)
          : []

        const deniedChars = deniedCharsInput
          ? deniedCharsInput
              .split(',')
              .map(c => c.trim().toLowerCase())
              .filter(c => c.length === 1)
          : []

        const knownPositions = {}
        for (let i = 1; i <= 5; i++) {
          const value = document.getElementById(`knownPos${i}`).value.trim()
          if (value.length === 1) {
            knownPositions[i] = value.toLowerCase()
          }
        }

        const rejectedPositions = {}
        for (let i = 1; i <= 5; i++) {
          const value = document.getElementById(`rejectedPos${i}`).value.trim()
          if (value) {
            const letters = value
              .split(',')
              .map(c => c.trim().toLowerCase())
              .filter(c => c.length === 1)
            if (letters.length > 0) {
              rejectedPositions[i] = letters
            }
          }
        }

        return {
          acceptedChars,
          deniedChars,
          knownPositions,
          rejectedPositions,
        }
      }

      function displayResults(words, requestData) {
        hideLoading()
        clearError()

        countBadge.textContent = `${words.length} word${words.length !== 1 ? 's' : ''}`

        wordsGrid.innerHTML = ''
        words.forEach(word => {
          const card = document.createElement('div')
          card.className = 'word-card'
          card.textContent = word
          card.addEventListener('click', () => {
            navigator.clipboard.writeText(word)
            const originalText = card.textContent
            card.textContent = 'Copied!'
            setTimeout(() => {
              card.textContent = originalText
            }, 1000)
          })
          wordsGrid.appendChild(card)
        })

        requestJson.textContent = JSON.stringify(requestData, null, 2)
        responseJson.textContent = JSON.stringify(
          {
            success: true,
            count: words.length,
            words: words,
            constraints: requestData,
          },
          null,
          2,
        )

        resultsContainer.style.display = 'block'
      }

      form.addEventListener('submit', async e => {
        e.preventDefault()

        const constraints = buildConstraints()
        showLoading()

        try {
          const words = await solveWordle(constraints)
          displayResults(words, constraints)
        } catch (error) {
          hideLoading()
          showError(`Error: ${error.message}`)
        }
      })

      // Auto-uppercase known positions
      for (let i = 1; i <= 5; i++) {
        const input = document.getElementById(`knownPos${i}`)
        input.addEventListener('input', e => {
          e.target.value = e.target.value.toUpperCase()
        })
      }

      // Load word list on page load
      loadWordList().catch(error => {
        console.error('Failed to preload word list:', error)
      })
    </script>
  </body>
</html>
